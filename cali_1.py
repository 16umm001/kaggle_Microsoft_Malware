# class 1 is the easiest to predict
import pandas as pd
import sys

# class 1 is the easiest to predict
# it is used as base.
'''
def cali_row(x):
    x.iloc[2:] = x[2:]/sum(x[2:]) * (1 - x[1])
    return x
'''


## this one seems better
def cali2_row(x, alpha = 0.85):
	x.iloc[8] = x[8] * alpha + (1- alpha) * (1 - max(sum(x[1:8]) + x[9], 1))
	x.iloc[2:] = x[2:]/sum(x[2:]) * (1 - x[1])
	return x

data = pd.read_csv(sys.argv[1])

#cali_data = data.apply(cali_row, axis = 1)
#cali_data.to_csv('cali_1_%s'%sys.argv[1], index = False)

cali2_data = data.apply(cali2_row, axis = 1)
cali2_data.to_csv('cali_2_%s'%sys.argv[1], index = False)

# sorted class by logloss:  1 3 7 5 4 2 9 6 8